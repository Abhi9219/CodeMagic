<!DOCTYPE html> 
<html>
	<head>
		<title>Code Magic</title>
		<meta charset="utf-8" />
		<script type="text/javascript" src="jquery-2.1.4.js"></script>
		<link rel="stylesheet" href="style.css" type="text/css">
	</head>
	<body>
		
		<div id="wrapper">
			<div id="menubar">
				<div id="logo">CodeMagic</div>
				<div id="buttonDiv">
					<button id="runButton">Run</button>
				</div>
				<ul id="toggles">
					<li class="toggle selected">HTML</li>
					<li class="toggle">CSS</li>
					<li class="toggle">JS</li>
					<li class="toggle selected" style="border-right: none;">Result</li>
				</ul>
			</div>
			<div class="clear"></div>

			<div class="codeContainer" id="HTMLContainer">
				<div class="codeLabel">HTML</div>
				<textarea id="htmlCode"><div id="hello"></div></textarea>
			</div>

			<div class="codeContainer" id="CSSContainer">
				<div class="codeLabel">CSS</div>
				<textarea id="cssCode">html {background-color: #8292A0;}</textarea>
			</div>

			<div class="codeContainer" id="JSContainer">
				<div class="codeLabel">JS</div>
				<textarea id="jsCode">document.getElementById("hello").innerHTML="Its Working!";</textarea>
			</div>

			<div class="codeContainer" id="ResultContainer">
				<div class="codeLabel">Result</div>
				<iframe id="resultFrame"></iframe>
			</div>

		</div>

		<script>
			var windowHeight = $(window).height();
			var menuHeight = $('#menubar').height();	
			var containerHeight = windowHeight - menuHeight;
			$('.codeContainer').height(containerHeight+"px");

			$('.toggle').click(function(){
				$(this).toggleClass('selected');
				var activeDiv = $(this).html();
				
				$("#"+activeDiv+"Container").toggle();

				var showingDivs = $(".codeContainer").filter(function() {
					return($(this).css("display")!="none");
				}).length;

				var width = 100/showingDivs;  
				$(".codeContainer").css("width", width+"%");
			});

			 $("#runButton").click(function() {
        
	            $("iframe").contents().find("html").html('<style>' +
	            $("#cssCode").val() + '</style>' + $("#htmlCode").val());

	            document.getElementById("resultFrame").contentWindow.eval($("#jsCode").val()); 
	                   
	            eval($("#jsCode").val());  
        });
		</script>
	</body>
</html> 